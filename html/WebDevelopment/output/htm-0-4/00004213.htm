<html><h1 class="refsect1">LAG_VARIANCE</h1>
<p><code>LAG_VARIANCE</code> returns the difference between values for the current time period and an earlier period.</p>
<p class="titleinrefsubsect"><a id="sthref176" name="sthref176"></a>Return Value</p>
<p>The same data type as the value expression</p>
<p class="titleinrefsubsect"><a id="sthref177" name="sthref177"></a>Syntax</p>
<pre xml:space="preserve" class="oac_no_warn"><span class="bold">LAG_VARIANCE (</span>lag_args<span class="bold">) OVER (</span>lag_clause<span class="bold">)</span>
</pre>
<p><span class="bolditalic">lag_args</span>::=</p>
<pre xml:space="preserve" class="oac_no_warn">expression, offset [, {default_expression | <span class="bold">CLOSEST</span>} ]
</pre>
<p><span class="bolditalic">lag_clause</span>::=</p>
<pre xml:space="preserve" class="oac_no_warn">[ {<span class="bold">DIMENSION</span> dimension_id | <span class="bold">HIERARCHY</span> hierarchy_id} ]
[ [<span class="bold">BY</span>] { <span class="bold">LEVEL</span> 
       | <span class="bold">PARENT</span> 
       | <span class="bold">GREGORIAN</span> {<span class="bold">YEAR</span> | <span class="bold">QUARTER</span> | <span class="bold">MONTH</span> | <span class="bold">WEEK</span> | <span class="bold">DAY</span>}
       | <span class="bold">ANCESTOR AT</span> { <span class="bold">DIMENSION LEVEL</span> dim_level_id
                      | <span class="bold">HIERARCHY LEVEL</span> hier_level_id
                      }
       }
                [<span class="bold">POSITION FROM</span> {<span class="bold">BEGINNING</span> | <span class="bold">END</span>}] 
] 
</pre>
<p class="titleinrefsubsect"><a id="sthref178" name="sthref178"></a>Arguments</p>
<p class="subhead2"><a id="OLAXS258" name="OLAXS258"></a><a id="sthref179" name="sthref179"></a><span class="italic">expression</span></p>
<p>A dimensional expression whose values you want to calculate.</p>
<p class="subhead2"><a id="OLAXS259" name="OLAXS259"></a><a id="sthref180" name="sthref180"></a><span class="italic">offset</span></p>
<p>A numeric expression for the number of periods to count back from the current time period.</p>
<p class="subhead2"><a id="OLAXS260" name="OLAXS260"></a><a id="sthref181" name="sthref181"></a><span class="italic">default_expression</span></p>
<p>The value returned when <code><span class="codeinlineitalic">offset</span></code> does not identify a valid period. This clause is either an expression of any data type or the <code>CLOSEST</code> keyword for the closest match. The closest match is the first member when counting back.</p>
<p class="subhead2"><a id="OLAXS261" name="OLAXS261"></a><a id="sthref182" name="sthref182"></a><span class="italic">dimension_id</span></p>
<p>The Time dimension over which the lag is calculated.</p>
<p class="subhead2"><a id="OLAXS262" name="OLAXS262"></a><a id="sthref183" name="sthref183"></a><span class="italic">hierarchy_id</span></p>
<p>The hierarchy over which the lag is calculated. Otherwise, the default hierarchy for <code><span class="codeinlineitalic">dimension_id</span></code> is used.</p>
<p class="subhead2"><a id="OLAXS263" name="OLAXS263"></a><a id="sthref184" name="sthref184"></a><span class="italic">dim_level_id</span></p>
<p>The name of a level of <code><span class="codeinlineitalic">dimension_id</span></code>.</p>
<p class="subhead2"><a id="OLAXS264" name="OLAXS264"></a><a id="sthref185" name="sthref185"></a><span class="italic">hier_level_id</span></p>
<p>The name of a level of <code><span class="codeinlineitalic">hierarchy_id</span></code>.</p>
<p class="subhead2"><a id="OLAXS265" name="OLAXS265"></a><a id="sthref186" name="sthref186"></a>BY subclause</p>
<p>The BY subclause identifies the range of time periods used when counting the offset. Following are descriptions of the keywords:</p>
<div class="inftblinformal">
<table class="Informal" title="LAG_VARIANCE Offset Units" summary="Offset units in LAG BY clause" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="32%" />
<col width="*" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t17">Offset Unit</th>
<th align="left" valign="bottom" id="r1c2-t17">Description</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t17" headers="r1c1-t17"><code>LEVEL</code></td>
<td align="left" headers="r2c1-t17 r1c2-t17">The member at the same level <code><span class="codeinlineitalic">offset</span></code> periods before the current member. (Default)</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t17" headers="r1c1-t17"><code>PARENT</code></td>
<td align="left" headers="r3c1-t17 r1c2-t17">The member at the same level with the same parent <code><span class="codeinlineitalic">offset</span></code> periods before the current member.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t17" headers="r1c1-t17"><code>GREGORIAN YEAR</code></td>
<td align="left" headers="r4c1-t17 r1c2-t17">The period at the same level with a start date exactly <code>offset</code> years before the start date of the current period.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t17" headers="r1c1-t17"><code>GREGORIAN QUARTER</code></td>
<td align="left" headers="r5c1-t17 r1c2-t17">The period at the same level with a start date exactly <code><span class="codeinlineitalic">offset</span></code> quarters before the start date of the current period.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r6c1-t17" headers="r1c1-t17"><code>GREGORIAN MONTH</code></td>
<td align="left" headers="r6c1-t17 r1c2-t17">The period at the same level with a start date exactly <code><span class="codeinlineitalic">offset</span></code> months before the start date of the current period.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r7c1-t17" headers="r1c1-t17"><code>GREGORIAN WEEK</code></td>
<td align="left" headers="r7c1-t17 r1c2-t17">The period at the same level with a start date exactly <code><span class="codeinlineitalic">offset</span></code> weeks before the start date of the current period.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r8c1-t17" headers="r1c1-t17"><code>GREGORIAN DAY</code></td>
<td align="left" headers="r8c1-t17 r1c2-t17">The period at the same level with a start date exactly <code><span class="codeinlineitalic">offset</span></code> days before the start date of the current period.</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r9c1-t17" headers="r1c1-t17"><code>ANCESTOR</code></td>
<td align="left" headers="r9c1-t17 r1c2-t17">The period at the same level as the current period and whose ancestor is <code><span class="codeinlineitalic">offset</span></code> positions before the ancestor of the current period.</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="titleinrefsubsect"><a id="sthref187" name="sthref187"></a>Examples</p>
<p>This example returns the difference in values between the current period and the equivalent period in the prior year.</p>
<p><code>LAG_VARIANCE (GLOBAL.UNITS_CUBE.UNITS, 1) OVER (HIERARCHY GLOBAL.TIME.CALENDAR ANCESTOR AT DIMENSION LEVEL GLOBAL.TIME.CALENDAR_YEAR)</code></p>
<div class="inftblinformal">
<table class="Informal" title="LAG-VARIANCE Example" summary="Output from LAG_VARIANCE example" dir="ltr" border="1" width="100%" frame="hsides" rules="groups" cellpadding="3" cellspacing="0">
<col width="*" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
<thead>
<tr align="left" valign="top">
<th align="left" valign="bottom" id="r1c1-t18">Time</th>
<th align="left" valign="bottom" id="r1c2-t18">Units</th>
<th align="left" valign="bottom" id="r1c3-t18">Last Year</th>
<th align="left" valign="bottom" id="r1c4-t18">Difference</th>
</tr>
</thead>
<tbody>
<tr align="left" valign="top">
<td align="left" id="r2c1-t18" headers="r1c1-t18">Q1.05</td>
<td align="left" headers="r2c1-t18 r1c2-t18">143607</td>
<td align="left" headers="r2c1-t18 r1c3-t18">146529</td>
<td align="left" headers="r2c1-t18 r1c4-t18">-2922</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r3c1-t18" headers="r1c1-t18">Q2.05</td>
<td align="left" headers="r3c1-t18 r1c2-t18">138096</td>
<td align="left" headers="r3c1-t18 r1c3-t18">143070</td>
<td align="left" headers="r3c1-t18 r1c4-t18">-4974</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r4c1-t18" headers="r1c1-t18">Q3.05</td>
<td align="left" headers="r4c1-t18 r1c2-t18">138953</td>
<td align="left" headers="r4c1-t18 r1c3-t18">148292</td>
<td align="left" headers="r4c1-t18 r1c4-t18">-9339</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r5c1-t18" headers="r1c1-t18">Q4.05</td>
<td align="left" headers="r5c1-t18 r1c2-t18">145062</td>
<td align="left" headers="r5c1-t18 r1c3-t18">149528</td>
<td align="left" headers="r5c1-t18 r1c4-t18">-4466</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r6c1-t18" headers="r1c1-t18">Q1.06</td>
<td align="left" headers="r6c1-t18 r1c2-t18">146819</td>
<td align="left" headers="r6c1-t18 r1c3-t18">143607</td>
<td align="left" headers="r6c1-t18 r1c4-t18">3212</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r7c1-t18" headers="r1c1-t18">Q2.06</td>
<td align="left" headers="r7c1-t18 r1c2-t18">145233</td>
<td align="left" headers="r7c1-t18 r1c3-t18">138096</td>
<td align="left" headers="r7c1-t18 r1c4-t18">7137</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r8c1-t18" headers="r1c1-t18">Q3.06</td>
<td align="left" headers="r8c1-t18 r1c2-t18">143572</td>
<td align="left" headers="r8c1-t18 r1c3-t18">138953</td>
<td align="left" headers="r8c1-t18 r1c4-t18">4619</td>
</tr>
<tr align="left" valign="top">
<td align="left" id="r9c1-t18" headers="r1c1-t18">Q4.06</td>
<td align="left" headers="r9c1-t18 r1c2-t18">149305</td>
<td align="left" headers="r9c1-t18 r1c3-t18">145062</td>
<td align="left" headers="r9c1-t18 r1c4-t18">4243</td>
</tr>
</tbody>
</table>
<br /></div>
<!-- class="inftblinformal" -->
<p class="titleinrefsubsect"><a id="sthref188" name="sthref188"></a>Related Topics</p>
<p><a href="olap_functions012.htm#CIHIEIEA">LAG</a>, <a href="olap_functions014.htm#CIHDEFDI">LAG_VARIANCE_PERCENT</a>, <a href="olap_functions015.htm#CIHGEABE">LEAD</a></p>
</div>
</html>